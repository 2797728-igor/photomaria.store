<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8" />
    <title>–†–µ–¥–∞–∫—Ç–æ—Ä –≥–∞–ª–µ—Ä–µ–π - Photomaria</title>
    <style>
        body { margin: 0; font-family: Arial; background: #f5f5f5; }
        .header { background: #2c3e50; color: white; padding: 15px 20px; }
        .container { max-width: 1200px; margin: 0 auto; padding: 20px; }
        .editor { background: white; padding: 20px; border-radius: 10px; margin: 20px 0; }
        .drop-zone { border: 2px dashed #3498db; padding: 40px; text-align: center; margin: 20px 0; border-radius: 10px; }
        .drop-zone.dragover { background: #e3f2fd; }
        .gallery-preview { display: grid; grid-template-columns: repeat(auto-fill, minmax(150px, 1fr)); gap: 10px; margin: 20px 0; }
        .image-preview { position: relative; border: 1px solid #ddd; border-radius: 5px; overflow: hidden; }
        .image-preview img { width: 100%; height: 150px; object-fit: cover; }
        .btn { background: #3498db; color: white; border: none; padding: 10px 20px; border-radius: 5px; cursor: pointer; margin: 5px; }
        .btn-success { background: #27ae60; }
        .btn-danger { background: #e74c3c; }
        .form-group { margin: 15px 0; }
        label { display: block; margin-bottom: 5px; font-weight: bold; }
        input, select, textarea { width: 100%; padding: 10px; border: 1px solid #ddd; border-radius: 5px; }
        .instructions { background: #e3f2fd; padding: 15px; border-radius: 5px; margin: 15px 0; }
    </style>
</head>
<body>
    <div class="header">
        <h1>üìù –†–µ–¥–∞–∫—Ç–æ—Ä –≥–∞–ª–µ—Ä–µ–π Photomaria</h1>
        <p>–°–æ–∑–¥–∞–Ω–∏–µ –∞–ª—å–±–æ–º–æ–≤ –¥–ª—è —Å–∞–π—Ç–∞ –Ω–∞ Hugo</p>
    </div>
    
    <div class="container">
        <div class="instructions">
            <strong>üí° –ö–∞–∫ —ç—Ç–æ —Ä–∞–±–æ—Ç–∞–µ—Ç:</strong>
            <p>–†–µ–¥–∞–∫—Ç–æ—Ä —Å–æ–∑–¥–∞—Å—Ç —Ñ–∞–π–ª—ã –≤ —Ñ–æ—Ä–º–∞—Ç–µ Hugo. –ü–æ—Å–ª–µ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è –≤–∞–º –Ω—É–∂–Ω–æ:</p>
            <ol>
                <li>–°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å —Å–æ–∑–¥–∞–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã –≤ –ø–∞–ø–∫—É <code>content/gallery/</code></li>
                <li>–°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å —Ñ–æ—Ç–æ –≤ –ø–∞–ø–∫—É <code>static/images/gallery/</code></li>
                <li>–ó–∞–ø—É—Å—Ç–∏—Ç—å <code>hugo --minify</code> –¥–ª—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è —Å–∞–π—Ç–∞</li>
            </ol>
        </div>
        
        <div class="editor">
            <h3>üé® –°–æ–∑–¥–∞–Ω–∏–µ –Ω–æ–≤–æ–π –≥–∞–ª–µ—Ä–µ–∏</h3>
            
            <div class="form-group">
                <label>–ù–∞–∑–≤–∞–Ω–∏–µ –∞–ª—å–±–æ–º–∞:</label>
                <input type="text" id="albumTitle" placeholder="–ù–∞–ø—Ä–∏–º–µ—Ä: –°–≤–∞–¥—å–±–∞ –ê–Ω–Ω—ã –∏ –ò–≤–∞–Ω–∞">
            </div>
            
            <div class="form-group">
                <label>–û–ø–∏—Å–∞–Ω–∏–µ –∞–ª—å–±–æ–º–∞:</label>
                <textarea id="albumDescription" rows="3" placeholder="–ö—Ä–∞—Ç–∫–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ —Ñ–æ—Ç–æ—Å–µ—Å—Å–∏–∏..."></textarea>
            </div>
            
            <div class="form-group">
                <label>–î–∞—Ç–∞ —Å—ä–µ–º–∫–∏:</label>
                <input type="date" id="albumDate">
            </div>
            
            <div class="form-group">
                <label>–ö–∞—Ç–µ–≥–æ—Ä–∏—è:</label>
                <select id="albumCategory">
                    <option value="—Å–≤–∞–¥—å–±—ã">üíí –°–≤–∞–¥—å–±—ã</option>
                    <option value="–ø–æ—Ä—Ç—Ä–µ—Ç—ã">üì∏ –ü–æ—Ä—Ç—Ä–µ—Ç—ã</option>
                    <option value="—Å–µ–º–µ–π–Ω—ã–µ">üë®‚Äçüë©‚Äçüëß‚Äçüë¶ –°–µ–º–µ–π–Ω—ã–µ</option>
                    <option value="–º–µ—Ä–æ–ø—Ä–∏—è—Ç–∏—è">üéâ –ú–µ—Ä–æ–ø—Ä–∏—è—Ç–∏—è</option>
                </select>
            </div>
            
            <div class="form-group">
                <label>üñºÔ∏è –§–æ—Ç–æ–≥—Ä–∞—Ñ–∏–∏:</label>
                <div class="drop-zone" id="dropZone">
                    <p>üìÅ –ü–µ—Ä–µ—Ç–∞—â–∏—Ç–µ —Ñ–æ—Ç–æ —Å—é–¥–∞ –∏–ª–∏ –Ω–∞–∂–º–∏—Ç–µ –¥–ª—è –≤—ã–±–æ—Ä–∞</p>
                    <p style="font-size: 12px; color: #666;">–ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞—é—Ç—Å—è JPG, PNG, WebP</p>
                    <input type="file" id="fileInput" multiple accept="image/*" style="display: none;">
                    <button class="btn" onclick="document.getElementById('fileInput').click()">üìÅ –í—ã–±—Ä–∞—Ç—å —Ñ–∞–π–ª—ã</button>
                </div>
            </div>
            
            <div id="fileCounter" style="text-align: center; margin: 10px 0; font-weight: bold;"></div>
            
            <div class="gallery-preview" id="galleryPreview"></div>
            
            <div style="text-align: center; margin: 20px 0;">
                <button class="btn btn-success" onclick="generateHugoFiles()">üíæ –°–æ–∑–¥–∞—Ç—å —Ñ–∞–π–ª—ã –¥–ª—è Hugo</button>
                <button class="btn" onclick="clearForm()">üîÑ –û—á–∏—Å—Ç–∏—Ç—å —Ñ–æ—Ä–º—É</button>
                <button class="btn btn-danger" onclick="window.close()">‚ùå –ó–∞–∫—Ä—ã—Ç—å</button>
            </div>
            
            <!-- –†–µ–∑—É–ª—å—Ç–∞—Ç -->
            <div id="result" style="display: none; margin-top: 30px; padding: 20px; background: #f8f9fa; border-radius: 10px;"></div>
        </div>
    </div>

    <script>
        let selectedFiles = [];
        const today = new Date().toISOString().split('T')[0];
        document.getElementById('albumDate').value = today;
        
        // –û–±—Ä–∞–±–æ—Ç–∫–∞ –ø–µ—Ä–µ—Ç–∞—Å–∫–∏–≤–∞–Ω–∏—è —Ñ–∞–π–ª–æ–≤
        const dropZone = document.getElementById('dropZone');
        const fileInput = document.getElementById('fileInput');
        
        dropZone.addEventListener('click', () => fileInput.click());
        dropZone.addEventListener('dragover', (e) => {
            e.preventDefault();
            dropZone.classList.add('dragover');
        });
        dropZone.addEventListener('dragleave', () => dropZone.classList.remove('dragover'));
        dropZone.addEventListener('drop', (e) => {
            e.preventDefault();
            dropZone.classList.remove('dragover');
            handleFiles(e.dataTransfer.files);
        });
        
        fileInput.addEventListener('change', (e) => handleFiles(e.target.files));
        
        function handleFiles(files) {
            const imageFiles = Array.from(files).filter(file => 
                file.type.startsWith('image/')
            );
            
            selectedFiles = [...selectedFiles, ...imageFiles];
            updatePreview();
            updateFileCounter();
        }
        
        function updatePreview() {
            const preview = document.getElementById('galleryPreview');
            preview.innerHTML = '';
            
            selectedFiles.forEach((file, index) => {
                const reader = new FileReader();
                reader.onload = (e) => {
                    const div = document.createElement('div');
                    div.className = 'image-preview';
                    div.innerHTML = `
                        <img src="${e.target.result}" alt="${file.name}">
                        <div style="padding: 5px; font-size: 12px; text-overflow: ellipsis; overflow: hidden; white-space: nowrap;">${file.name}</div>
                        <button onclick="removeImage(${index})" style="position: absolute; top: 5px; right: 5px; background: #e74c3c; color: white; border: none; border-radius: 50%; width: 20px; height: 20px; font-size: 12px;">√ó</button>
                    `;
                    preview.appendChild(div);
                };
                reader.readAsDataURL(file);
            });
        }
        
        function updateFileCounter() {
            const counter = document.getElementById('fileCounter');
            counter.textContent = `üì∏ –í—ã–±—Ä–∞–Ω–æ —Ñ–∞–π–ª–æ–≤: ${selectedFiles.length}`;
            counter.style.color = selectedFiles.length > 0 ? '#27ae60' : '#666';
        }
        
        function removeImage(index) {
            selectedFiles.splice(index, 1);
            updatePreview();
            updateFileCounter();
        }
        
        function clearForm() {
            document.getElementById('albumTitle').value = '';
            document.getElementById('albumDescription').value = '';
            document.getElementById('albumDate').value = today;
            document.getElementById('albumCategory').value = '—Å–≤–∞–¥—å–±—ã';
            selectedFiles = [];
            updatePreview();
            updateFileCounter();
            document.getElementById('result').style.display = 'none';
        }
        
        function generateHugoFiles() {
            const title = document.getElementById('albumTitle').value.trim();
            const description = document.getElementById('albumDescription').value.trim();
            const date = document.getElementById('albumDate').value;
            const category = document.getElementById('albumCategory').value;
            
            // –í–∞–ª–∏–¥–∞—Ü–∏—è
            if (!title) {
                alert('–í–≤–µ–¥–∏—Ç–µ –Ω–∞–∑–≤–∞–Ω–∏–µ –∞–ª—å–±–æ–º–∞');
                return;
            }
            
            if (selectedFiles.length === 0) {
                alert('–î–æ–±–∞–≤—å—Ç–µ —Ö–æ—Ç—è –±—ã –æ–¥–Ω–æ —Ñ–æ—Ç–æ');
                return;
            }
            
            // –°–æ–∑–¥–∞–µ–º slug –∏–∑ –Ω–∞–∑–≤–∞–Ω–∏—è
            const slug = title.toLowerCase()
                .replace(/[^\w\u0400-\u04FF]+/g, '-')
                .replace(/^-+|-+$/g, '');
            
            // –ì–µ–Ω–µ—Ä–∏—Ä—É–µ–º —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ Markdown —Ñ–∞–π–ª–∞
            const markdownContent = `---
title: "${title}"
date: ${date}T10:00:00+03:00
description: "${description}"
category: "${category}"
images:
${selectedFiles.map((file, index) => `  - image: "/images/gallery/${slug}/${file.name}"`).join('\n')}
---

# ${title}

${description}

<!-- –ì–∞–ª–µ—Ä–µ—è –±—É–¥–µ—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Å–æ–∑–¥–∞–Ω–∞ –∏–∑ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π —É–∫–∞–∑–∞–Ω–Ω—ã—Ö –≤—ã—à–µ -->
`;
            
            // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º —Ä–µ–∑—É–ª—å—Ç–∞—Ç
            const resultDiv = document.getElementById('result');
            resultDiv.style.display = 'block';
            resultDiv.innerHTML = `
                <h3>‚úÖ –§–∞–π–ª—ã –¥–ª—è Hugo —Å–æ–∑–¥–∞–Ω—ã!</h3>
                
                <div class="instructions">
                    <h4>üìã –ß—Ç–æ –Ω—É–∂–Ω–æ —Å–¥–µ–ª–∞—Ç—å:</h4>
                    <ol>
                        <li><strong>–°–æ–∑–¥–∞–π—Ç–µ –ø–∞–ø–∫—É:</strong> <code>static/images/gallery/${slug}/</code></li>
                        <li><strong>–°–∫–æ–ø–∏—Ä—É–π—Ç–µ —Ñ–æ—Ç–æ</strong> –≤ —Å–æ–∑–¥–∞–Ω–Ω—É—é –ø–∞–ø–∫—É</li>
                        <li><strong>–°–æ–∑–¥–∞–π—Ç–µ —Ñ–∞–π–ª:</strong> <code>content/gallery/${slug}.md</code></li>
                        <li><strong>–í—Å—Ç–∞–≤—å—Ç–µ —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ</strong> –Ω–∏–∂–µ –≤ —Ñ–∞–π–ª</li>
                        <li><strong>–ó–∞–ø—É—Å—Ç–∏—Ç–µ:</strong> <code>hugo --minify</code></li>
                    </ol>
                </div>
                
                <div style="margin: 20px 0;">
                    <button class="btn btn-success" onclick="copyToClipboard()">üìã –°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å Markdown</button>
                    <button class="btn" onclick="downloadMarkdown()">üì• –°–∫–∞—á–∞—Ç—å .md —Ñ–∞–π–ª</button>
                    <button class="btn" onclick="downloadFileList()">üìã –°–∫–∞—á–∞—Ç—å —Å–ø–∏—Å–æ–∫ —Ñ–∞–π–ª–æ–≤</button>
                </div>
                
                <h4>üìÑ –°–æ–¥–µ—Ä–∂–∏–º–æ–µ —Ñ–∞–π–ª–∞ ${slug}.md:</h4>
                <pre style="background: #2c3e50; color: white; padding: 15px; border-radius: 5px; overflow-x: auto; font-size: 12px;">${markdownContent}</pre>
                
                <h4>üìÅ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ —Ñ–∞–π–ª–æ–≤:</h4>
                <pre style="background: #34495e; color: white; padding: 15px; border-radius: 5px; font-size: 12px;">
content/
‚îî‚îÄ‚îÄ gallery/
    ‚îî‚îÄ‚îÄ <strong>${slug}.md</strong>

static/images/gallery/
‚îî‚îÄ‚îÄ <strong>${slug}/</strong>
${selectedFiles.map(file => `    ‚îî‚îÄ‚îÄ ${file.name}`).join('\n')}
                </pre>
            `;
            
            // –°–æ—Ö—Ä–∞–Ω—è–µ–º –¥–∞–Ω–Ω—ã–µ –¥–ª—è —Å–∫–∞—á–∏–≤–∞–Ω–∏—è
            window.currentGalleryData = {
                slug,
                markdownContent,
                files: selectedFiles
            };
        }
        
        function copyToClipboard() {
            const textArea = document.createElement('textarea');
            textArea.value = window.currentGalleryData.markdownContent;
            document.body.appendChild(textArea);
            textArea.select();
            document.execCommand('copy');
            document.body.removeChild(textArea);
            alert('‚úÖ Markdown —Å–∫–æ–ø–∏—Ä–æ–≤–∞–Ω –≤ –±—É—Ñ–µ—Ä –æ–±–º–µ–Ω–∞!');
        }
        
        function downloadMarkdown() {
            const data = window.currentGalleryData;
            const blob = new Blob([data.markdownContent], { type: 'text/markdown' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = `${data.slug}.md`;
            document.body.appendChild(a);
            a.click();
            document.body.removeChild(a);
            URL.revokeObjectURL(url);
        }
        
        function downloadFileList() {
            const data = window.currentGalleryData;
            const fileList = selectedFiles.map(file => file.name).join('\n');
            const blob = new Blob([fileList], { type: 'text/plain' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = `${data.slug}-files.txt`;
            document.body.appendChild(a);
            a.click();
            document.body.removeChild(a);
            URL.revokeObjectURL(url);
        }
        
        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è
        updateFileCounter();
    </script>
</body>
</html>